"use strict";

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");
Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.computeChecksumForAws = computeChecksumForAws;
exports.computeEndpointChecksum = computeEndpointChecksum;
var _openapiTraverser = require("@useoptic/openapi-utilities/build/openapi3/implementations/openapi3/openapi-traverser");
var _crypto = require("crypto");
var _jsonStableStringify = _interopRequireDefault(require("json-stable-stringify"));
function computeChecksumForAws(file) {
  const hash = (0, _crypto.createHash)('sha256');
  hash.update(file);
  return hash.digest('base64');
}
function computeEndpointChecksum(path, method, endpointContent) {
  const hash = (0, _crypto.createHash)('sha256');
  const normalizedUrlPath = (0, _openapiTraverser.normalizeOpenApiPath)(path);
  const normalizedContent = {
    [normalizedUrlPath]: {
      [method]: endpointContent
    }
  };
  hash.update((0, _jsonStableStringify.default)(normalizedContent));
  return hash.digest('hex');
}