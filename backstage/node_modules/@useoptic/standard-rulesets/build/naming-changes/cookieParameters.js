"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.createCookieParameterChecks = void 0;
const rulesets_base_1 = require("@useoptic/rulesets-base");
const isCase_1 = require("./isCase");
const createCookieParameterChecks = (applies, format) => {
    const parameterTest = (parameter) => {
        if (!(0, isCase_1.isCase)(parameter.value.name, format)) {
            throw new rulesets_base_1.RuleError({
                message: `${parameter.value.name} is not ${format}`,
            });
        }
    };
    const cookieParameterChecks = new rulesets_base_1.OperationRule({
        name: 'cookie parameter naming check',
        rule: (operationAssertions) => {
            if (applies === 'always') {
                operationAssertions.cookieParameter.requirement(parameterTest);
            }
            else if (applies === 'addedOrChanged') {
                operationAssertions.cookieParameter.added(parameterTest);
                operationAssertions.cookieParameter.changed((_before, after) => parameterTest(after));
            }
            else if (applies === 'added') {
                operationAssertions.cookieParameter.added(parameterTest);
            }
        },
    });
    return cookieParameterChecks;
};
exports.createCookieParameterChecks = createCookieParameterChecks;
//# sourceMappingURL=cookieParameters.js.map